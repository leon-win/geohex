!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Geohex=e():t.Geohex=e()}(this,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e),n.d(e,"getCellByCode",(function(){return f})),n.d(e,"getCellByLocation",(function(){return h})),n.d(e,"getCellByXY",(function(){return s})),n.d(e,"getXYByCode",(function(){return d})),n.d(e,"getXYByLocation",(function(){return g}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function r(t){return 20037508.34/Math.pow(3,t+3)}function l(t,e,n){const o=Math.pow(3,n+2),r=Math.abs(t-e);if(r===o&&t>e)return{x:e,y:t};if(r>o){const n=r-o,l=Math.floor(n/2),a=n-l;if(t>e)return{x:e+a+l,y:t-l-a};if(e>t)return{x:e-a-l,y:t+l+a}}return{x:t,y:e}}function a(t,e){return{x:20037508.34*t/180,y:Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180)*20037508.34/180}}function c(t,e){return{lon:t/20037508.34*180,lat:180/Math.PI*(2*Math.atan(Math.exp(e/20037508.34*Math.PI))-Math.PI/2)}}class u{constructor(t,e,n,o,r){this.lat=t,this.lon=e,this.x=n,this.y=o,this.code=r}getZoomLevel(){return this.code.length-2}getHexSize(){return r(this.getZoomLevel())}getHexCoords(){const{lat:t,lon:e}=this,{x:n,y:o}=a(e,t),r=Math.tan(Math.PI*(60/180)),l=this.getHexSize(),u=c(n,o+r*l).lat,i=c(n,o-r*l).lat,f=c(n-2*l,o).lon,h=c(n+2*l,o).lon,s=c(n-1*l,o).lon,d=c(n+1*l,o).lon;return[{lat:t,lon:f},{lat:u,lon:s},{lat:u,lon:d},{lat:t,lon:h},{lat:i,lon:d},{lat:i,lon:s}]}}const i=Math.tan(Math.PI*(30/180));function f(t){const{x:e,y:n}=d(t);return s(e,n,t.length-2)}function h(t,e,n){const{x:o,y:r}=g(t,e,n);return s(o,r,n)}function s(t,e,n){const l=r(n),a=6*l*i,f=(i*t*(6*l)+e*a)/2,h=(f-e*a)/i,s=Math.pow(3,n+2),d=Math.abs(t-e);let{lon:g,lat:y}=c(h,f),p=t,M=e;return d===s&&(t>e&&(p=e,M=t),g=-180),new u(y,g,t,e,function(t,e,n,r){const l=[],a=[];let c="",u="",i="";for(let o=0;o<=r+2;o++){const c=Math.pow(3,r+2-o);t>=Math.ceil(c/2)?(l[o]=2,t-=c):t<=-Math.ceil(c/2)?(l[o]=0,t+=c):l[o]=1,e>=Math.ceil(c/2)?(a[o]=2,e-=c):e<=-Math.ceil(c/2)?(a[o]=0,e+=c):a[o]=1,2===o&&(-180===n||n>=0)&&(2===l[0]&&1===a[0]&&l[1]===a[1]&&l[2]===a[2]?(l[0]=1,a[0]=2):1===l[0]&&0===a[0]&&l[1]===a[1]&&l[2]===a[2]&&(l[0]=0,a[0]=1))}for(let t=0;t<l.length;t++)u+=""+l[t]+a[t],i+=parseInt(u,3),c+=i,u="",i="";const f=c.substring(0,3),h=c.substring(3),s=Math.floor(f/30),d=f%30;return o.charAt(s)+o.charAt(d)+h}(p,M,g,n))}function d(t){const e=t.length-2;let n=""+(30*o.indexOf(t.charAt(0))+o.indexOf(t.charAt(1)))+t.substring(2);n.charAt(0).match(/[15]/)&&n.charAt(1).match(/[^125]/)&&n.charAt(2).match(/[^125]/)&&(5===n.charAt(0)?n="7"+n.substring(1,n.length):1===n.charAt(0)&&(n="3"+n.substring(1,n.length)));let r=n.length;for(let t=0;t<e+3-r;t++)n="0"+n,r++;let a="";for(let t=0;t<r;t++){const e=parseInt(n.charAt(t)).toString(3);e?1===e.length&&(a+="0"):a+="00",a+=e}const c=[],u=[];for(let t=0;t<a.length/2;t++)c[t]=parseInt(a.charAt(2*t)),u[t]=parseInt(a.charAt(2*t+1));let i=0,f=0;for(let t=0;t<=e+2;t++){const n=Math.pow(3,e+2-t);0===c[t]?i-=n:2===c[t]&&(i+=n),0===u[t]?f-=n:2===u[t]&&(f+=n)}return l(i,f,e)}function g(t,e,n){const o=r(n),c=6*o,u=6*o*i,{x:f,y:h}=a(e,t),s=(f+h/i)/c,d=(h-i*f)/u,g=Math.floor(s),y=Math.floor(d),p=s-g,M=d-y;let x=Math.round(s),b=Math.round(d);return M>1-p?M<2*p&&M>.5*p&&(x=g+1,b=y+1):M<1-p&&M>2*p-1&&M<.5*p+.5&&(x=g,b=y),l(x,b,n)}e.default={getCellByCode:f,getCellByLocation:h,getCellByXY:s,getXYByCode:d,getXYByLocation:g}}])}));