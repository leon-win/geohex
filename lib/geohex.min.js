!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.geohex=n():t.geohex=n()}(this,(function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(o,r,function(n){return t[n]}.bind(null,r));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n),e.d(n,"getCellByCode",(function(){return f})),e.d(n,"getCellByLocation",(function(){return h})),e.d(n,"getCellByXY",(function(){return s})),e.d(n,"getXYByCode",(function(){return d})),e.d(n,"getXYByLocation",(function(){return g}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function r(t){return 20037508.34/Math.pow(3,t+3)}function l(t,n,e){const o=Math.pow(3,e+2),r=Math.abs(t-n);if(r===o&&t>n)return{x:n,y:t};if(r>o){const e=r-o,l=Math.floor(e/2),a=e-l;if(t>n)return{x:n+a+l,y:t-l-a};if(n>t)return{x:n-a-l,y:t+l+a}}return{x:t,y:n}}function a(t,n){return{x:20037508.34*t/180,y:Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180)*20037508.34/180}}function u(t,n){return{lon:t/20037508.34*180,lat:180/Math.PI*(2*Math.atan(Math.exp(n/20037508.34*Math.PI))-Math.PI/2)}}class c{constructor(t,n,e,o,r){this.lat=t,this.lon=n,this.x=e,this.y=o,this.code=r}getZoomLevel(){return this.code.length-2}getHexSize(){return r(this.getZoomLevel())}getHexCoords(){const{lat:t,lon:n}=this,{x:e,y:o}=a(n,t),r=Math.tan(Math.PI*(60/180)),l=this.getHexSize(),c=u(e,o+r*l).lat,i=u(e,o-r*l).lat,f=u(e-2*l,o).lon,h=u(e+2*l,o).lon,s=u(e-1*l,o).lon,d=u(e+1*l,o).lon;return[{lat:t,lon:f},{lat:c,lon:s},{lat:c,lon:d},{lat:t,lon:h},{lat:i,lon:d},{lat:i,lon:s}]}}const i=Math.tan(Math.PI*(30/180));function f(t){const{x:n,y:e}=d(t);return s(n,e,t.length-2)}function h(t,n,e){const{x:o,y:r}=g(t,n,e);return s(o,r,e)}function s(t,n,e){const l=r(e),a=6*l*i,f=(i*t*(6*l)+n*a)/2,h=(f-n*a)/i,s=Math.pow(3,e+2),d=Math.abs(t-n);let{lon:g,lat:p}=u(h,f),M=t,y=n;return d===s&&(t>n&&(M=n,y=t),g=-180),new c(p,g,t,n,function(t,n,e,r){const l=[],a=[];let u="",c="",i="";for(let o=0;o<=r+2;o++){const u=Math.pow(3,r+2-o);t>=Math.ceil(u/2)?(l[o]=2,t-=u):t<=-Math.ceil(u/2)?(l[o]=0,t+=u):l[o]=1,n>=Math.ceil(u/2)?(a[o]=2,n-=u):n<=-Math.ceil(u/2)?(a[o]=0,n+=u):a[o]=1,2===o&&(-180===e||e>=0)&&(2===l[0]&&1===a[0]&&l[1]===a[1]&&l[2]===a[2]?(l[0]=1,a[0]=2):1===l[0]&&0===a[0]&&l[1]===a[1]&&l[2]===a[2]&&(l[0]=0,a[0]=1))}for(let t=0;t<l.length;t++)c+=""+l[t]+a[t],i+=parseInt(c,3),u+=i,c="",i="";const f=u.substring(0,3),h=u.substring(3),s=Math.floor(f/30),d=f%30;return o.charAt(s)+o.charAt(d)+h}(M,y,g,e))}function d(t){const n=t.length-2;let e=""+(30*o.indexOf(t.charAt(0))+o.indexOf(t.charAt(1)))+t.substring(2);e.charAt(0).match(/[15]/)&&e.charAt(1).match(/[^125]/)&&e.charAt(2).match(/[^125]/)&&(5===e.charAt(0)?e="7"+e.substring(1,e.length):1===e.charAt(0)&&(e="3"+e.substring(1,e.length)));let r=e.length;for(let t=0;t<n+3-r;t++)e="0"+e,r++;let a="";for(let t=0;t<r;t++){const n=parseInt(e.charAt(t)).toString(3);n?1===n.length&&(a+="0"):a+="00",a+=n}const u=[],c=[];for(let t=0;t<a.length/2;t++)u[t]=parseInt(a.charAt(2*t)),c[t]=parseInt(a.charAt(2*t+1));let i=0,f=0;for(let t=0;t<=n+2;t++){const e=Math.pow(3,n+2-t);0===u[t]?i-=e:2===u[t]&&(i+=e),0===c[t]?f-=e:2===c[t]&&(f+=e)}return l(i,f,n)}function g(t,n,e){const o=r(e),u=6*o,c=6*o*i,{x:f,y:h}=a(n,t),s=(f+h/i)/u,d=(h-i*f)/c,g=Math.floor(s),p=Math.floor(d),M=s-g,y=d-p;let x=Math.round(s),b=Math.round(d);return y>1-M?y<2*M&&y>.5*M&&(x=g+1,b=p+1):y<1-M&&y>2*M-1&&y<.5*M+.5&&(x=g,b=p),l(x,b,e)}}])}));