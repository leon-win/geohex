!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.geohex=e():t.geohex=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e),n.d(e,"getCellByCode",(function(){return f})),n.d(e,"getCellByLocation",(function(){return h})),n.d(e,"getCellByXY",(function(){return s})),n.d(e,"getXYByCode",(function(){return d})),n.d(e,"getXYByLocation",(function(){return g}));const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";class o{constructor(t,e,n,r,o){this.lat=t,this.lon=e,this.x=n,this.y=r,this.code=o}getZoomLevel(){return this.code.length-2}getHexSize(){return l(this.getZoomLevel())}getHexCoords(){const{lat:t,lon:e}=this,{x:n,y:r}=c(e,t),o=Math.tan(Math.PI*(60/180)),l=this.getHexSize(),a=u(n,r+o*l).lat,i=u(n,r-o*l).lat,f=u(n-2*l,r).lon,h=u(n+2*l,r).lon,s=u(n-1*l,r).lon,d=u(n+1*l,r).lon;return[{lat:t,lon:f},{lat:a,lon:s},{lat:a,lon:d},{lat:t,lon:h},{lat:i,lon:d},{lat:i,lon:s}]}}function l(t){return 20037508.34/Math.pow(3,t+3)}function a(t,e,n){const r=Math.pow(3,n+2),o=Math.abs(t-e);if(o===r&&t>e)return{x:e,y:t,rev:1};if(o>r){const n=o-r,l=Math.floor(n/2),a=n-l;if(t>e)return{x:e+a+l,y:t-l-a,rev:0};if(e>t)return{x:e-a-l,y:t+l+a,rev:0}}return{x:t,y:e,rev:0}}function c(t,e){return{x:20037508.34*t/180,y:Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180)*20037508.34/180}}function u(t,e){return{lon:t/20037508.34*180,lat:180/Math.PI*(2*Math.atan(Math.exp(e/20037508.34*Math.PI))-Math.PI/2)}}const i=Math.tan(Math.PI*(30/180));function f(t){const{x:e,y:n}=d(t);return s(e,n,t.length-2)}function h(t,e,n){const{x:r,y:o}=g(t,e,n);return s(r,o,n)}function s(t,e,n){const a=l(n),c=6*a*i,f=(i*t*(6*a)+e*c)/2,h=(f-e*c)/i,s=Math.pow(3,n+2),d=Math.abs(t-e);let{lon:g,lat:p}=u(h,f),M=t,y=e;d===s&&(t>e&&(M=e,y=t),g=-180);const x=function(t,e,n,o){const l=[],a=[];let c="",u="",i="";for(let r=0;r<=o+2;r++){const c=Math.pow(3,o+2-r);t>=Math.ceil(c/2)?(l[r]=2,t-=c):t<=-Math.ceil(c/2)?(l[r]=0,t+=c):l[r]=1,e>=Math.ceil(c/2)?(a[r]=2,e-=c):e<=-Math.ceil(c/2)?(a[r]=0,e+=c):a[r]=1,2===r&&(-180===n||n>=0)&&(2===l[0]&&1===a[0]&&l[1]===a[1]&&l[2]===a[2]?(l[0]=1,a[0]=2):1===l[0]&&0===a[0]&&l[1]===a[1]&&l[2]===a[2]&&(l[0]=0,a[0]=1))}for(let t=0;t<l.length;t++)u+=""+l[t]+a[t],i+=parseInt(u,3),c+=i,u="",i="";const f=c.substring(0,3),h=c.substring(3),s=Math.floor(f/30),d=f%30;return r.charAt(s)+r.charAt(d)+h}(M,y,g,n);return new o(p,g,t,e,x)}function d(t){const e=t.length-2;let n=""+(30*r.indexOf(t.charAt(0))+r.indexOf(t.charAt(1)))+t.substring(2);n.charAt(0).match(/[15]/)&&n.charAt(1).match(/[^125]/)&&n.charAt(2).match(/[^125]/)&&(5===n.charAt(0)?n="7"+n.substring(1,n.length):1===n.charAt(0)&&(n="3"+n.substring(1,n.length)));let o=n.length;for(let t=0;t<e+3-o;t++)n="0"+n,o++;let l="";for(let t=0;t<o;t++){const e=parseInt(n.charAt(t)).toString(3);e?1===e.length&&(l+="0"):l+="00",l+=e}const c=[],u=[];for(let t=0;t<l.length/2;t++)c[t]=parseInt(l.charAt(2*t)),u[t]=parseInt(l.charAt(2*t+1));let i=0,f=0;for(let t=0;t<=e+2;t++){const n=Math.pow(3,e+2-t);0===c[t]?i-=n:2===c[t]&&(i+=n),0===u[t]?f-=n:2===u[t]&&(f+=n)}return a(i,f,e)}function g(t,e,n){const r=l(n),o=6*r,u=6*r*i,{x:f,y:h}=c(e,t),s=(f+h/i)/o,d=(h-i*f)/u,g=Math.floor(s),p=Math.floor(d),M=s-g,y=d-p;let x=Math.round(s),b=Math.round(d);return y>1-M?y<2*M&&y>.5*M&&(x=g+1,b=p+1):y<1-M&&y>2*M-1&&y<.5*M+.5&&(x=g,b=p),a(x,b,n)}}])}));